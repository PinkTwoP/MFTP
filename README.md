# Maximum Flow based Target Path-cover (MFTP)

Description
---
The maximum flow based target path-cover (MFTP) algorithm aims to find the minimum number of driver nodes to structurally control the target subset from a complex network.\
\
The detailed information of MFTP would be available in the main paper.
Here is a brief introduction to the proposed algorithm:\
\
Given a subset extracted from a directed complex network, for the purpose of structural controllability, we endeavor to find the minimum number of driver nodes, i.e., given a subset <a href="http://www.codecogs.com/eqnedit.php?latex=S" target="_blank"><img src="http://latex.codecogs.com/gif.latex?S" title="S" /></a> from a digraph <a href="http://www.codecogs.com/eqnedit.php?latex=D(V,E)" target="_blank"><img src="http://latex.codecogs.com/gif.latex?D(V,E)" title="D(V,E)" /></a> corresponding to a linear system <a href="http://www.codecogs.com/eqnedit.php?latex=(A,B)" target="_blank"><img src="http://latex.codecogs.com/gif.latex?(A,B)" title="(A,B)" /></a>, MFTP finds the minimum <a href="http://www.codecogs.com/eqnedit.php?latex=n_D" target="_blank"><img src="http://latex.codecogs.com/gif.latex?n_D" title="n_D" /></a> for structural controllability, where <a href="http://www.codecogs.com/eqnedit.php?latex=V" target="_blank"><img src="http://latex.codecogs.com/gif.latex?V" title="V" /></a> is the vertex set, <a href="http://www.codecogs.com/eqnedit.php?latex=E" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E" title="E" /></a> is the edge set and <a href="http://www.codecogs.com/eqnedit.php?latex=n_D" target="_blank"><img src="http://latex.codecogs.com/gif.latex?n_D" title="n_D" /></a> is minimum number of driver nodes.\
\
The alrotihm mainly consists of seven steps which can be divided into three parts: the pre-process procedure part, the maximum flow problem solving and sorting the paths:
>***the "pre-pcocess procedure" part***:
>>**Step 1**: For a given  graph  network <a href="http://www.codecogs.com/eqnedit.php?latex=D(V,E)" target="_blank"><img src="http://latex.codecogs.com/gif.latex?D(V,E)" title="D(V,E)" /></a>,  build a new graph network  <a href="http://www.codecogs.com/eqnedit.php?latex=D^{(N)}=(V^{(N)},E^{(N)})" target="_blank"><img src="http://latex.codecogs.com/gif.latex?D^{(N)}=(V^{(N)},E^{(N)})" title="D^{(N)}=(V^{(N)},E^{(N)})" /></a> according to  procedure (a)-(d) which is shown in Figure 1:
>>>**a)** For every node <a href="http://www.codecogs.com/eqnedit.php?latex=v\in&space;V" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v\in&space;V" title="v\in V" /></a>,  split  it  into two nodes    <a href="http://www.codecogs.com/eqnedit.php?latex=v^{in}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v^{in}" title="v^{in}" /></a> and <a href="http://www.codecogs.com/eqnedit.php?latex=v^{out}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v^{out}" title="v^{out}" /></a>. Define a node set <a href="http://www.codecogs.com/eqnedit.php?latex=V^{(I)}=\{v^{in}|v\in&space;V\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?V^{(I)}=\{v^{in}|v\in&space;V\}" title="V^{(I)}=\{v^{in}|v\in V\}" /></a>, <a href="http://www.codecogs.com/eqnedit.php?latex=V^{(O)}=\{v^{out}|v\in&space;V\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?V^{(O)}=\{v^{out}|v\in&space;V\}" title="V^{(O)}=\{v^{out}|v\in V\}" /></a>.\
\
>>>**b)** Define <a href="http://www.codecogs.com/eqnedit.php?latex=V^{(N)}=V^{(I)}&space;\cup&space;V^{(O)}&space;\cup&space;\{v_s,&space;v_t\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?V^{(N)}=V^{(I)}&space;\cup&space;V^{(O)}&space;\cup&space;\{v_s,&space;v_t\}" title="V^{(N)}=V^{(I)} \cup V^{(O)} \cup \{v_s, v_t\}" /></a> where <a href="http://www.codecogs.com/eqnedit.php?latex=v_s" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_s" title="v_s" /></a>  represents  the source and <a href="http://www.codecogs.com/eqnedit.php?latex=v_t" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_t" title="v_t" /></a>    represents    the sink. By setting the upper bound of each edge as <a href="http://www.codecogs.com/eqnedit.php?latex=c\left((v_i,v_j)\right)=1" target="_blank"><img src="http://latex.codecogs.com/gif.latex?c\left((v_i,v_j)\right)=1" title="c\left((v_i,v_j)\right)=1" /></a> where <a href="http://www.codecogs.com/eqnedit.php?latex=$v_i,&space;v_j\in&space;V^{(N)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_i,&space;v_j\in&space;V^{(N)}$" title="$v_i, v_j\in V^{(N)}$" /></a> and lower bound as <a href="http://www.codecogs.com/eqnedit.php?latex=$l((v_{sub}^{in},v_{sub}^{out}))=1$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$l((v_{sub}^{in},v_{sub}^{out}))=1$" title="$l((v_{sub}^{in},v_{sub}^{out}))=1$" /></a> and <a href="http://www.codecogs.com/eqnedit.php?latex=$l((v_i,v_j))=0$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$l((v_i,v_j))=0$" title="$l((v_i,v_j))=0$" /></a> where <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_i,v_j)\notin&space;E-\{(v_{sub}^{in},v_{sub}^{out})\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_i,v_j)\notin&space;E-\{(v_{sub}^{in},v_{sub}^{out})\}$" title="$(v_i,v_j)\notin E-\{(v_{sub}^{in},v_{sub}^{out})\}$" /></a>, we build a flow network denoted as
 <a href="http://www.codecogs.com/eqnedit.php?latex=$(D^{(N)},&space;cap)$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(D^{(N)},&space;cap)$" title="$(D^{(N)}, cap)$" /></a> where <a href="http://www.codecogs.com/eqnedit.php?latex=$cap$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$cap$" title="$cap$" /></a> denotes the capacity function.\
 \
 >>>**c)** Construct  the  edge sets  <a href="http://www.codecogs.com/eqnedit.php?latex=E^{(1)}=&space;\{(v_t,&space;v^{out})&space;|&space;v\in&space;S\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E^{(1)}=&space;\{(v_t,&space;v^{out})&space;|&space;v\in&space;S\}$" title="E^{(1)}= \{(v_t, v^{out}) | v\in S\}$" /></a>,  <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(2)}=&space;\{(v^{(in)},&space;s)&space;|&space;v\in&space;S\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(2)}=&space;\{(v^{(in)},&space;s)&space;|&space;v\in&space;S\}$" title="$E^{(2)}= \{(v^{(in)}, s) | v\in S\}$" /></a>,   <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(3)}=&space;\{(v^{in},&space;v^{out})&space;|&space;v&space;\not\in&space;S\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(3)}=&space;\{(v^{in},&space;v^{out})&space;|&space;v&space;\not\in&space;S\}$" title="$E^{(3)}= \{(v^{in}, v^{out}) | v \not\in S\}$" /></a>,  <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(4)}=&space;\{(v^{out}_i,&space;v^{in}_j)&space;|&space;(v_i,v_j)\in&space;E\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(4)}=&space;\{(v^{out}_i,&space;v^{in}_j)&space;|&space;(v_i,v_j)\in&space;E\}$" title="$E^{(4)}= \{(v^{out}_i, v^{in}_j) | (v_i,v_j)\in E\}$" /></a>  and <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(N)}=&space;E^{(1)}&space;\cup&space;E^{(2)}&space;\cup&space;E^{(3)}&space;\cup&space;E^{(4)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(N)}=&space;E^{(1)}&space;\cup&space;E^{(2)}&space;\cup&space;E^{(3)}&space;\cup&space;E^{(4)}$" title="$E^{(N)}= E^{(1)} \cup E^{(2)} \cup E^{(3)} \cup E^{(4)}$" /></a>.\
 \
 >>>**d)** For  each  edge  <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_i,v_j)\in&space;E^{(N)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_i,v_j)\in&space;E^{(N)}$" title="$(v_i,v_j)\in E^{(N)}$" /></a>,   set  its upper capacity as <a href="http://www.codecogs.com/eqnedit.php?latex=$c((v_i,v_j))=1$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$c((v_i,v_j))=1$" title="$c((v_i,v_j))=1$" /></a>.
 
 >***the "maximum flow problem solving" part***
 >>**Step 2**: Define      <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(F)}=\{(v_i,v_j)&space;|&space;(v^{out}_i,&space;v^{in}_j)\in&space;E^{(4)},&space;flow((v^{out}_i,&space;v^{in}_j))=1\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(F)}=\{(v_i,v_j)&space;|&space;(v^{out}_i,&space;v^{in}_j)\in&space;E^{(4)},&space;flow((v^{out}_i,&space;v^{in}_j))=1\}$" title="$E^{(F)}=\{(v_i,v_j) | (v^{out}_i, v^{in}_j)\in E^{(4)}, flow((v^{out}_i, v^{in}_j))=1\}$" /></a>.
    Obtain  the edge set  <a href="http://www.codecogs.com/eqnedit.php?latex=$E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$E^{(F)}$" title="$E^{(F)}$" /></a>   by applying  the  Dinic algorithm [1][2] to  the  maximum flow problem  in <a href="http://www.codecogs.com/eqnedit.php?latex=$(D^{(N)},&space;cap,&space;v_s,v_t)$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(D^{(N)},&space;cap,&space;v_s,v_t)$" title="$(D^{(N)}, cap, v_s,v_t)$" /></a>.   Let  directed path set <a href="http://www.codecogs.com/eqnedit.php?latex=$P\leftarrow&space;\emptyset$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$P\leftarrow&space;\emptyset$" title="$P\leftarrow \emptyset$" /></a>, circle path set <a href="http://www.codecogs.com/eqnedit.php?latex=$\mathcal{C}\leftarrow&space;\emptyset$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$\mathcal{C}\leftarrow&space;\emptyset$" title="$\mathcal{C}\leftarrow \emptyset$" /></a>,  do the following steps:
 
 >***the "sorting the paths" part***
 >>**Step 3**: For each node <a href="http://www.codecogs.com/eqnedit.php?latex=$v_i\in&space;S$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_i\in&space;S$" title="$v_i\in S$" /></a>, if there does not exist a node <a href="http://www.codecogs.com/eqnedit.php?latex=$v_j&space;\in&space;V$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_j&space;\in&space;V$" title="$v_j \in V$" /></a> such that <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_i,v_j)&space;\in&space;E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_i,v_j)&space;\in&space;E^{(F)}$" title="$(v_i,v_j) \in E^{(F)}$" /></a> or <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_j,v_i)&space;\in&space;E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_j,v_i)&space;\in&space;E^{(F)}$" title="$(v_j,v_i) \in E^{(F)}$" /></a>,  then  update
<a href="http://www.codecogs.com/eqnedit.php?latex=$P\leftarrow&space;P&space;\cup&space;\{(v_i)\}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$P\leftarrow&space;P&space;\cup&space;\{(v_i)\}$" title="$P\leftarrow P \cup \{(v_i)\}$" /></a>, i.e., add all the simple paths that contain  only a single node  <a href="http://www.codecogs.com/eqnedit.php?latex=$v_i$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_i$" title="$v_i$" /></a> to <a href="http://www.codecogs.com/eqnedit.php?latex=P" target="_blank"><img src="http://latex.codecogs.com/gif.latex?P" title="P" /></a>.\
\
>>**Step 4**: Find one node <a href="http://www.codecogs.com/eqnedit.php?latex=$v_1$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_1$" title="$v_1$" /></a> such that there  exist  no  node <a href="http://www.codecogs.com/eqnedit.php?latex=$v_0$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_0$" title="$v_0$" /></a> satisfying <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_0,v_1)&space;\in&space;E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_0,v_1)&space;\in&space;E^{(F)}$" title="$(v_0,v_1) \in E^{(F)}$" /></a>. Continue  the process to find nodes <a href="http://www.codecogs.com/eqnedit.php?latex=$v_2,...,v_p$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_2,...,v_p$" title="$v_2,...,v_p$" /></a> which form a unique sequence <a href="http://www.codecogs.com/eqnedit.php?latex=$v_1v_2...v_p$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_1v_2...v_p$" title="$v_1v_2...v_p$" /></a> such that <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{p-1},&space;v_p)\in&space;E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{p-1},&space;v_p)\in&space;E^{(F)}$" title="$(v_1, v_2), (v_2, v_3), ... , (v_{p-1}, v_p)\in E^{(F)}$" /></a> until there does not exist <a href="http://www.codecogs.com/eqnedit.php?latex=$v_{p&plus;1}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_{p&plus;1}$" title="$v_{p+1}$" /></a> satisfying that <a href="http://www.codecogs.com/eqnedit.php?latex=$(v_{p},&space;v_{p&plus;1})\in&space;E^{(F)}$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$(v_{p},&space;v_{p&plus;1})\in&space;E^{(F)}$" title="$(v_{p}, v_{p+1})\in E^{(F)}$" /></a>. Then,  add the path <a href="http://www.codecogs.com/eqnedit.php?latex=$v_1&space;v_2&space;...&space;v_p$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$v_1&space;v_2&space;...&space;v_p$" title="$v_1 v_2 ... v_p$" /></a> to <a href="http://www.codecogs.com/eqnedit.php?latex=$P$" target="_blank"><img src="http://latex.codecogs.com/gif.latex?$P$" title="$P$" /></a>, i.e., update   <a href="http://www.codecogs.com/eqnedit.php?latex=P\leftarrow&space;P\cup&space;\{v_1&space;v_2&space;...&space;v_p\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?P\leftarrow&space;P\cup&space;\{v_1&space;v_2&space;...&space;v_p\}" title="P\leftarrow P\cup \{v_1 v_2 ... v_p\}" /></a> and delete all the edges <a href="http://www.codecogs.com/eqnedit.php?latex=(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{p-1},&space;v_p)\in&space;E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{p-1},&space;v_p)\in&space;E^{(F)}" title="(v_1, v_2), (v_2, v_3), ... , (v_{p-1}, v_p)\in E^{(F)}" /></a>.\
\
>>**Step 5**: Repeat **Step  4** until no more <a href="http://www.codecogs.com/eqnedit.php?latex=v_1" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_1" title="v_1" /></a>  can be found.\
\
>>**Step 6**: If there exists any edge in <a href="http://www.codecogs.com/eqnedit.php?latex=E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E^{(F)}" title="E^{(F)}" /></a>, then for  an arbitrary edge <a href="http://www.codecogs.com/eqnedit.php?latex=(v_1,&space;v_2)\in&space;E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?(v_1,&space;v_2)\in&space;E^{(F)}" title="(v_1, v_2)\in E^{(F)}" /></a>,  find a unique sequence <a href="http://www.codecogs.com/eqnedit.php?latex=v_3,&space;v_4,&space;...,&space;v_c" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_3,&space;v_4,&space;...,&space;v_c" title="v_3, v_4, ..., v_c" /></a> such that
  <a href="http://www.codecogs.com/eqnedit.php?latex=(v_2,&space;v_3),&space;...&space;,&space;(v_{c-1},&space;v_c),&space;(v_{c},&space;v_1)\in&space;E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?(v_2,&space;v_3),&space;...&space;,&space;(v_{c-1},&space;v_c),&space;(v_{c},&space;v_1)\in&space;E^{(F)}" title="(v_2, v_3), ... , (v_{c-1}, v_c), (v_{c}, v_1)\in E^{(F)}" /></a>. As will be proved  in Theorem  3 in the main paper   such node  <a href="http://www.codecogs.com/eqnedit.php?latex=v_1" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_1" title="v_1" /></a>  always exists. Then,  add the path <a href="http://www.codecogs.com/eqnedit.php?latex=v_1&space;v_2&space;...&space;v_c&space;v_1" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_1&space;v_2&space;...&space;v_c&space;v_1" title="v_1 v_2 ... v_c v_1" /></a> to <a href="http://www.codecogs.com/eqnedit.php?latex=\mathcal&space;C" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\mathcal&space;C" title="\mathcal C" /></a> and update   <a href="http://www.codecogs.com/eqnedit.php?latex=\mathcal{C}\leftarrow&space;\mathcal{C}\cup&space;\{v_1&space;v_2&space;...&space;v_c&space;v_1\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\mathcal{C}\leftarrow&space;\mathcal{C}\cup&space;\{v_1&space;v_2&space;...&space;v_c&space;v_1\}" title="\mathcal{C}\leftarrow \mathcal{C}\cup \{v_1 v_2 ... v_c v_1\}" /></a>,  and delete all the edges <a href="http://www.codecogs.com/eqnedit.php?latex=(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{c},&space;v_1)\in&space;E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?(v_1,&space;v_2),&space;(v_2,&space;v_3),&space;...&space;,&space;(v_{c},&space;v_1)\in&space;E^{(F)}" title="(v_1, v_2), (v_2, v_3), ... , (v_{c}, v_1)\in E^{(F)}" /></a>.\
\
>>**Step 7**: Repeat the process in **Step  6**  until <a href="http://www.codecogs.com/eqnedit.php?latex=E^{(F)}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E^{(F)}" title="E^{(F)}" /></a> becomes an empty set, and all the simple paths and circles in <a href="http://www.codecogs.com/eqnedit.php?latex=P" target="_blank"><img src="http://latex.codecogs.com/gif.latex?P" title="P" /></a> and <a href="http://www.codecogs.com/eqnedit.php?latex=\mathcal{C}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\mathcal{C}" title="\mathcal{C}" /></a> are  finally obtained.

`Figure 1`
<div align=center><img width="610" height="550" src="/Figure/Figure-1.png" alt="Figure 1"/></div>

Files
---
* ./Code/NetworkData/ER_Network_1000node_3meandegree.mat -----> a 1000-node ER network data with 3 mean degree (mat-data)
* ./Code/main.m -----> the main script code of MFTP algorithm (matlab code)
* ./Code/C++/max_cost_flow/max_cost_flow_exe/FuncProduceSubset.m	-----> the function code to generate subsets(matlab code)
* ./Code/C++/max_cost_flow/max_cost_flow_exe/max_cost_flow.exe -----> the C++ executable file to do MFTP algorithm (C++ code)
* ./Code/C++/max_cost_flow/max_cost_flow -----> the C++ code of MFTP algorithm (C++ code)
* ./Figure/Figure-1.png -----> figure 1 (figure)
* ./Figure/Figure-2.png -----> figure 2 (figure)
* ./Figure/Figure-3.png -----> figure 2 (figure)

Example
---
Consider a simple   example  in Figure 2,  the target node set is selected as <a href="http://www.codecogs.com/eqnedit.php?latex=S=\{node~2,&space;node~3,&space;node~7,&space;node~9\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?S=\{node~2,&space;node~3,&space;node~7,&space;node~9\}" title="S=\{node~2, node~3, node~7, node~9\}" /></a>.  The   matrices  <a href="http://www.codecogs.com/eqnedit.php?latex=A" target="_blank"><img src="http://latex.codecogs.com/gif.latex?A" title="A" /></a> and <a href="http://www.codecogs.com/eqnedit.php?latex=C" target="_blank"><img src="http://latex.codecogs.com/gif.latex?C" title="C" /></a> are  given by

<a href="http://www.codecogs.com/eqnedit.php?latex=A=\left(&space;\begin{array}{cccccccccccccccccc}&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;1&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;\\&space;0&space;&1&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&1&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&1&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&1&space;&0&space;\\&space;\end{array}&space;\right)," target="_blank"><img src="http://latex.codecogs.com/gif.latex?A=\left(&space;\begin{array}{cccccccccccccccccc}&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;1&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;\\&space;0&space;&1&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&1&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;&1&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&1&space;&0&space;\\&space;\end{array}&space;\right)," title="A=\left( \begin{array}{cccccccccccccccccc} 0 &0 &0 &0 &0 &0 &0 &0 &0 \\ 1 &0 &0 &0 &0 &1 &0 &0 &0 \\ 0 &1 &0 &0 &0 &1 &0 &0 &0 \\ 0 &0 &1 &0 &0 &0 &1 &0 &0 \\ 0 &0 &0 &0 &0 &0 &0 &0 &0 \\ 0 &0 &0 &0 &1 &0 &0 &0 &1 \\ 0 &0 &0 &0 &0 &1 &0 &0 &1 \\ 0 &0 &0 &0 &0 &0 &0 &0 &0 \\ 0 &0 &0 &0 &0 &1 &0 &1 &0 \\ \end{array} \right)," /></a>

<a href="http://www.codecogs.com/eqnedit.php?latex=C=\left(&space;\begin{array}{cccccccccccccccccc}&space;0&space;&1&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&1&space;\\&space;\end{array}&space;\right)." target="_blank"><img src="http://latex.codecogs.com/gif.latex?C=\left(&space;\begin{array}{cccccccccccccccccc}&space;0&space;&1&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&1&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&1&space;&0&space;&0&space;\\&space;0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&0&space;&1&space;\\&space;\end{array}&space;\right)." title="C=\left( \begin{array}{cccccccccccccccccc} 0 &1 &0 &0 &0 &0 &0 &0 &0 \\ 0 &0 &1 &0 &0 &0 &0 &0 &0 \\ 0 &0 &0 &0 &0 &0 &1 &0 &0 \\ 0 &0 &0 &0 &0 &0 &0 &0 &1 \\ \end{array} \right)." /></a>

Here is a step by step explanation:
>**1.** For the network in Figure 2, we first use the graph transfer methods *`node splitting`* to get a graph with node set <a href="http://www.codecogs.com/eqnedit.php?latex=V^{(N)}=V\cup&space;V^{(I)}\cup&space;V^{(O)}\cup&space;{v_s,v_t}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?V^{(N)}=V\cup&space;V^{(I)}\cup&space;V^{(O)}\cup&space;{v_s,v_t}" title="V^{(N)}=V\cup V^{(I)}\cup V^{(O)}\cup {v_s,v_t}" /></a> and edge set <a href="http://www.codecogs.com/eqnedit.php?latex=E^{(N)}=E\cup&space;\{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E^{(N)}=E\cup&space;\{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" title="E^{(N)}=E\cup \{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" /></a>.\
\
>**2.** Then use the graph transfer methods *`associate graph construct`* and reverse the direction of edges in <a href="http://www.codecogs.com/eqnedit.php?latex=\{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" title="\{(v_s,v_i^{in})\}\cup\{(v_i^{out},v_t)\}" /></a> to get the graph shown in Figure 3.\
\
>**3.** After this, use Dinic algorithm to get the maximum flow from $v_t$ to $v_s$ which is obviously 

><a href="http://www.codecogs.com/eqnedit.php?latex=f(e)&space;=&space;\begin{cases}&space;1,&space;e&space;\in&space;\left\{\begin{array}{c}&space;(v_t,v_2^{out}),(v_2^{out},v_3^{in}),(v_3^{in},v_s),\\&space;(v_s,v_9^{out}),(v_9^{out},v_7^{in}),(v_7^{in},v_s)\\&space;(v_t,v_3^{out}),(v_3^{out},v_6^{in}),(v_6^{in},v_6^{out}),\\&space;(v_6^{out},v_2^{in}),(v_2^{in},v_s)&space;\end{array}\right\}\\&space;0,&space;others&space;\end{cases}." target="_blank"><img src="http://latex.codecogs.com/gif.latex?f(e)&space;=&space;\begin{cases}&space;1,&space;e&space;\in&space;\left\{\begin{array}{c}&space;(v_t,v_2^{out}),(v_2^{out},v_3^{in}),(v_3^{in},v_s),\\&space;(v_s,v_9^{out}),(v_9^{out},v_7^{in}),(v_7^{in},v_s)\\&space;(v_t,v_3^{out}),(v_3^{out},v_6^{in}),(v_6^{in},v_6^{out}),\\&space;(v_6^{out},v_2^{in}),(v_2^{in},v_s)&space;\end{array}\right\}\\&space;0,&space;others&space;\end{cases}." title="f(e) = \begin{cases} 1, e \in \left\{\begin{array}{c} (v_t,v_2^{out}),(v_2^{out},v_3^{in}),(v_3^{in},v_s),\\ (v_s,v_9^{out}),(v_9^{out},v_7^{in}),(v_7^{in},v_s)\\ (v_t,v_3^{out}),(v_3^{out},v_6^{in}),(v_6^{in},v_6^{out}),\\ (v_6^{out},v_2^{in}),(v_2^{in},v_s) \end{array}\right\}\\ 0, others \end{cases}." /></a>

>**4.** Thus according to **step 2** of MFTP, <a href="http://www.codecogs.com/eqnedit.php?latex=E^{(F)}=\{(v_2,v_3),(v_7,v_9),(v_3,v_6),(v_6,v_2)\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?E^{(F)}=\{(v_2,v_3),(v_7,v_9),(v_3,v_6),(v_6,v_2)\}" title="E^{(F)}=\{(v_2,v_3),(v_7,v_9),(v_3,v_6),(v_6,v_2)\}" /></a>. We set <a href="http://www.codecogs.com/eqnedit.php?latex=P\gets&space;\emptyset" target="_blank"><img src="http://latex.codecogs.com/gif.latex?P\gets&space;\emptyset" title="P\gets \emptyset" /></a> and <a href="http://www.codecogs.com/eqnedit.php?latex=\mathcal&space;C\gets&space;\emptyset" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\mathcal&space;C\gets&space;\emptyset" title="\mathcal C\gets \emptyset" /></a>.\
\
>**5.** Then we add path <a href="http://www.codecogs.com/eqnedit.php?latex=v_9v_7" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_9v_7" title="v_9v_7" /></a> into <a href="http://www.codecogs.com/eqnedit.php?latex=P" target="_blank"><img src="http://latex.codecogs.com/gif.latex?P" title="P" /></a> according to **step 4** and **step 5** of MFTP, and add <a href="http://www.codecogs.com/eqnedit.php?latex=v_2v_3v_6v_2" target="_blank"><img src="http://latex.codecogs.com/gif.latex?v_2v_3v_6v_2" title="v_2v_3v_6v_2" /></a> into <a href="http://www.codecogs.com/eqnedit.php?latex=\mathcal&space;C" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\mathcal&space;C" title="\mathcal C" /></a> according to **step 6** and **step 7** of MFTP.\
\
>**6.** Thus the control matrix <a href="http://www.codecogs.com/eqnedit.php?latex=B" target="_blank"><img src="http://latex.codecogs.com/gif.latex?B" title="B" /></a> is <a href="http://www.codecogs.com/eqnedit.php?latex=B=[0~&space;1~&space;0~&space;0~&space;0~&space;0~&space;0~&space;0~&space;1]^T" target="_blank"><img src="http://latex.codecogs.com/gif.latex?B=[0~&space;1~&space;0~&space;0~&space;0~&space;0~&space;0~&space;0~&space;1]^T" title="B=[0~ 1~ 0~ 0~ 0~ 0~ 0~ 0~ 1]^T" /></a>, i.e., applying one driver source onto node 9 and node 2.

`Figure 2`
<div align=center><img width="240" height="228" src="/Figure/Figure-2.png" alt="Figure 2"/></div>

`Figure 3`
<div align=center><img width="540" height="300" src="/Figure/Figure-3.png" alt="Figure 3"/></div>

Reference
---
[1] Dinic, E. A. "Algorithm for solution of a problem of maximum flow in a network with power estimation, soviet math. doll. 11 (5), 1277-1280,(1970)." English translation by RF. Rinehart.\
[2] [Dinitz, Yefim. "Dinitz’algorithm: The original version and Even’s version." Theoretical computer science. Springer, Berlin, Heidelberg, 2006. 218-240.](https://link.springer.com/chapter/10.1007/11685654_10)

Contact
---
For any questions regarding MFTP algorithm, please email:\
Tang Pei tangp14@mails.tsinghua.edu.cn
